"""
Алгоритм сортировки вставками (Insertion Sort)
-----------------------------------------------
Принцип: берём элементы по одному и вставляем каждый
на правильное место в уже отсортированную левую часть.
Похоже на то, как человек сортирует карты в руке.

Временна́я сложность:
  Лучший случай  — O(n)    (список уже отсортирован)
  Средний случай — O(n²)
  Худший случай  — O(n²)   (список отсортирован в обратном порядке)

Пространственная сложность: O(1)
"""


def insertion_sort(lst: list) -> list:
    """
    Сортировка вставками.

    Принимает список, возвращает новый отсортированный список.
    Исходный список не изменяется.
    """
    arr = lst.copy()       # Работаем с копией, чтобы не менять оригинал
    n = len(arr)

    # Начинаем со второго элемента — первый считается уже «отсортированным»
    for i in range(1, n):
        key = arr[i]   # Элемент, который нужно вставить на правильное место
        j = i - 1      # Начинаем сравнивать с предыдущим элементом

        # Сдвигаем элементы отсортированной части вправо, пока они больше key
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]  # Сдвигаем элемент на одну позицию вправо
            j -= 1

        # Вставляем key на найденное место
        arr[j + 1] = key

    return arr


# ---------------------------------------------------------------------------
# Демонстрация
# ---------------------------------------------------------------------------
if __name__ == "__main__":
    sample = [64, 34, 25, 12, 22, 11, 90]
    print(f"Исходный список:      {sample}")
    print(f"Отсортированный список: {insertion_sort(sample)}")
